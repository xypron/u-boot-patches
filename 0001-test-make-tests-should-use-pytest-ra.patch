From 0083941b75fd44246ebf2c75e31b446dc1ba3b7b Mon Sep 17 00:00:00 2001
From: Heinrich Schuchardt <xypron.glpk@gmx.de>
Date: Wed, 29 Apr 2020 18:17:50 +0200
Subject: [PATCH 1/1] test: make tests should use pytest -ra

By passing -ra to pytest we get a summary indicating which tests failed
and why tests were skipped.

Here is an example output:

======================== short test summary info =========================
SKIPPED [1] test/py/tests/test_efi_loader.py:81: No DHCP server available
SKIPPED [1] test/py/tests/test_efi_loader.py:100: No static network
configuration is defined
SKIPPED [2] test/py/tests/test_efi_loader.py:115: Network not initialized

Signed-off-by: Heinrich Schuchardt <xypron.glpk@gmx.de>
---
 test/run | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/test/run b/test/run
index 27331a8e40..4b22b55e08 100755
--- a/test/run
+++ b/test/run
@@ -22,12 +22,12 @@ failures=0
 
 if [ -z "$tools_only" ]; then
 	# Run all tests that the standard sandbox build can support
-	run_test "sandbox" ./test/py/test.py --bd sandbox --build \
+	run_test "sandbox" ./test/py/test.py -ra --bd sandbox --build \
 		-m "${mark_expr}"
 fi
 
 # Run tests which require sandbox_spl
-run_test "sandbox_spl" ./test/py/test.py --bd sandbox_spl --build \
+run_test "sandbox_spl" ./test/py/test.py -ra --bd sandbox_spl --build \
 		-k 'test_ofplatdata or test_handoff'
 
 if [ -z "$tools_only" ]; then
@@ -35,7 +35,7 @@ if [ -z "$tools_only" ]; then
 	# build which does not enable CONFIG_OF_LIVE for the live device tree, so we can
 	# check that functionality is the same. The standard sandbox build (above) uses
 	# CONFIG_OF_LIVE.
-	run_test "sandbox_flattree" ./test/py/test.py --bd sandbox_flattree \
+	run_test "sandbox_flattree" ./test/py/test.py -ra --bd sandbox_flattree \
 		--build -k test_ut
 fi
 
-- 
2.26.2

