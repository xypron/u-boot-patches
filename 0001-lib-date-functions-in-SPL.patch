From de5ec545f6bcbc6f62bf672d7d8c5ea1c0f82e52 Mon Sep 17 00:00:00 2001
From: Heinrich Schuchardt <xypron.glpk@gmx.de>
Date: Wed, 15 Apr 2020 12:32:13 +0200
Subject: [PATCH] lib: date functions in SPL

Date function are only needed in SPL if SPL contains RTC drivers.

Fixes: 05429b6cf5b3 ("rtc: move date.c from drivers/rtc/ to lib/")
Signed-off-by: Heinrich Schuchardt <xypron.glpk@gmx.de>
---
 lib/Makefile | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/lib/Makefile b/lib/Makefile
index 5d4bb3232c..87b85d22d8 100644
--- a/lib/Makefile
+++ b/lib/Makefile
@@ -116,13 +116,14 @@ else
 obj-$(CONFIG_$(SPL_TPL_)SPRINTF) += vsprintf.o
 endif
 obj-$(CONFIG_$(SPL_TPL_)STRTO) += strto.o
+obj-CONFIG_$(SPL_TPL_)RTC_SUPPORT += date.o
 else
 # Main U-Boot always uses the full printf support
 obj-y += vsprintf.o strto.o
 obj-$(CONFIG_OID_REGISTRY) += oid_registry.o
+obj-y += date.o
 endif
 
-obj-y += date.o
 obj-$(CONFIG_LIB_ELF) += elf.o
 
 #
-- 
2.20.1

